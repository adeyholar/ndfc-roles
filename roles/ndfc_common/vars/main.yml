---
# ndfc_common/vars/main.yml

# Multi-Site Domain (MSD) Fabric parameters

msd_fabrics:
  MSD:
    name: MSD
    type: msd
    L2_SEGMENT_ID_RANGE: 30000-49000
    L3_PARTITION_ID_RANGE: 50000-59000
    ANYCAST_GW_MAC: 2020.0000.00aa
    MS_LOOPBACK_ID: 100
    BORDER_GWY_CONNECTIONS: Direct_To_BGWS
    MS_UNDERLAY_AUTOCONFIG: true
    DELAY_RESTORE: 300
    LOOPBACK100_IP_RANGE: 10.100.0.0/24
    DCI_SUBNET_RANGE: 10.100.1.0/24
    DCI_SUBNET_TARGET_MASK: 30
  msd_test_1:
    name: msd_test_1
    type: msd
    L2_SEGMENT_ID_RANGE: 30000-49000
    L3_PARTITION_ID_RANGE: 50000-59000
    ANYCAST_GW_MAC: 2020.0000.00aa
    MS_LOOPBACK_ID: 100
    BORDER_GWY_CONNECTIONS: Direct_To_BGWS
    MS_UNDERLAY_AUTOCONFIG: true
    DELAY_RESTORE: 300
    LOOPBACK100_IP_RANGE: 10.100.0.0/24
    DCI_SUBNET_RANGE: 10.100.1.0/24
    DCI_SUBNET_TARGET_MASK: 30

# Switch Fabric parameters
# Multicast replication mode requires the following: 
#
#   ANYCAST_RP_IP_RANGE: 10.254.1.0/24
#   REPLICATION_MODE: Multicast
#
# Ingress replication mode, requires the following (note that
# ANYCAST_RP_IP_RANGE needs to be commented, or removed, if 
# REPLICATION_MODE is set to Ingress):
#
#   # ANYCAST_RP_IP_RANGE: COMMENTED OR REMOVED
#   REPLICATION_MODE: Ingress

switch_fabrics:
  f1:
    name: f1
    type: switch
    BGP_AS: 65001
    #ANYCAST_RP_IP_RANGE: 10.254.1.0/24
    LOOPBACK0_IP_RANGE: 10.2.0.0/22
    LOOPBACK1_IP_RANGE: 10.3.0.0/22
    SUBNET_RANGE: 10.4.0.0/16
    FABRIC_MTU: 9216
    REPLICATION_MODE: Ingress
  f2:
    name: f2
    type: switch
    BGP_AS: 65002
    #ANYCAST_RP_IP_RANGE: 10.254.1.0/24
    LOOPBACK0_IP_RANGE: 10.6.0.0/22
    LOOPBACK1_IP_RANGE: 10.7.0.0/22
    SUBNET_RANGE: 10.8.0.0/16
    FABRIC_MTU: 9216
    REPLICATION_MODE: Ingress

  f3:
    name: f3
    type: switch
    BGP_AS: 65003
    #ANYCAST_RP_IP_RANGE: 10.254.1.0/24
    LOOPBACK0_IP_RANGE: 10.36.0.0/22
    LOOPBACK1_IP_RANGE: 10.37.0.0/22
    SUBNET_RANGE: 10.38.0.0/16
    FABRIC_MTU: 9216
    REPLICATION_MODE: Ingress

# External fabric parameters
external_fabrics:
  sn_fabric_1:
    name: sn_fabric_1
    type: external
    BGP_AS: 65201
    DCI_SUBNET_RANGE: 10.101.1.0/24
    DCI_SUBNET_TARGET_MASK: 30
    LOOPBACK0_IP_RANGE: 10.201.0.0/22
    POWER_REDUNDANCY_MODE: ps-redundant
    SUBINTERFACE_RANGE: 2-511
  sn_fabric_2:
    name: sn_fabric_2
    type: external
    BGP_AS: 65202
    DCI_SUBNET_RANGE: 10.102.1.0/24
    DCI_SUBNET_TARGET_MASK: 30
    LOOPBACK0_IP_RANGE: 10.202.0.0/22
    POWER_REDUNDANCY_MODE: ps-redundant
    SUBINTERFACE_RANGE: 2-511
  sn_fabric_3:
    name: sn_fabric_3
    type: external
    BGP_AS: 65203
    DCI_SUBNET_RANGE: 10.103.1.0/24
    DCI_SUBNET_TARGET_MASK: 30
    LOOPBACK0_IP_RANGE: 10.203.0.0/22
    POWER_REDUNDANCY_MODE: ps-redundant
    SUBINTERFACE_RANGE: 2-511
  ext_fabric_test:
    name: ext_fabric_test
    type: external
    BGP_AS: 65204
    DCI_SUBNET_RANGE: 10.104.1.0/24
    DCI_SUBNET_TARGET_MASK: 30
    LOOPBACK0_IP_RANGE: 10.204.0.0/22
    POWER_REDUNDANCY_MODE: ps-redundant
    SUBINTERFACE_RANGE: 2-511

devices:
  # switch_fabric f1 ----------------------------------------------
  leaf_1:
    name: leaf_1
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.102
    role: leaf
  leaf_2:
    name: leaf_2
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.103
    role: leaf
  leaf_3:
    name: leaf_3
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.104
    role: leaf
  leaf_4:
    name: leaf_4
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.105
    role: leaf
  spine_1:
    name: spine_1
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.112
    role: spine
  spine_2:
    name: spine_2
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.113
    role: spine
  border_gateway_1:
    name: border_gateway_1
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.110
    role: border_gateway
  border_gateway_2:
    name: border_gateway_2
    switch_fabric: "{{ switch_fabrics.f1.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.111
    role: border_gateway
  # switch_fabric f2 ----------------------------------------------
  leaf_5:
    name: leaf_5
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.106
    role: leaf
  leaf_6:
    name: leaf_6
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.107
    role: leaf
  leaf_7:
    name: leaf_7
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.108
    role: leaf
  leaf_8:
    name: leaf_8
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.109
    role: leaf
  spine_3:
    name: spine_3
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.114
    role: spine
  spine_4:
    name: spine_4
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.115
    role: spine
  border_gateway_3:
    name: border_gateway_3
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.100
    role: border_gateway
  border_gateway_4:
    name: border_gateway_4
    switch_fabric: "{{ switch_fabrics.f2.name }}"
    msd_fabric: "{{ msd_fabrics.MSD.name }}"
    ip: 172.22.150.101
    role: border_gateway


port_groups:
  pg11:
  - Port-channel11
  pg12:
  - Port-channel12

networks:
  f1_n1111:
    name: f1_n1111 # name must be unique across all fabrics
    fabric: "{{ switch_fabrics.f1.name }}"
    net_name: n1111 # can be the same across fabrics
    vrf_name: v1
    vlan_id: 1111
    gw_ip_subnet: "10.21.1.1/24"
    tag: 12345 # used in service_route_peerings
    attach:
      - ip_address: "{{ devices.leaf_1.ip }}"
        ports: "{{ port_groups.pg11 }}"
      - ip_address: "{{ devices.leaf_2.ip }}"
        ports: "{{ port_groups.pg11 }}"
      - ip_address: "{{ devices.leaf_3.ip }}"
        ports: "{{ port_groups.pg11 }}"
      - ip_address: "{{ devices.leaf_4.ip }}"
        ports: "{{ port_groups.pg11 }}"

  f1_n1112:
    name: f1_n1112
    fabric: "{{ switch_fabrics.f1.name }}"
    net_name: n1112
    vrf_name: v2
    vlan_id: 1112
    gw_ip_subnet: "10.22.1.1/24"
    tag: 12345
    attach:
      - ip_address: "{{ devices.leaf_1.ip }}"
        ports: "{{ port_groups.pg12 }}"
      - ip_address: "{{ devices.leaf_2.ip }}"
        ports: "{{ port_groups.pg12 }}"
      - ip_address: "{{ devices.leaf_3.ip }}"
        ports: "{{ port_groups.pg12 }}"
      - ip_address: "{{ devices.leaf_4.ip }}"
        ports: "{{ port_groups.pg12 }}"

  f2_n1111:
    name: f2_n1111
    fabric: "{{ switch_fabrics.f2.name }}"
    net_name: n1111
    vrf_name: v1
    vlan_id: 1111
    gw_ip_subnet: "10.21.1.1/24"
    tag: 12345
    attach:
    - ip_address: "{{ devices.leaf_5.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_8.ip }}"
      ports: "{{ port_groups.pg11 }}"

  f2_n1112:
    name: f2_n1112
    fabric: "{{ switch_fabrics.f2.name }}"
    net_name: n1112
    vrf_name: v2
    vlan_id: 1112
    gw_ip_subnet: "10.22.1.1/24"
    tag: 12345
    attach:
    - ip_address: "{{ devices.leaf_5.ip }}"
      ports: "{{ port_groups.pg12 }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
      ports: "{{ port_groups.pg12 }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
      ports: "{{ port_groups.pg12 }}"
    - ip_address: "{{ devices.leaf_8.ip }}"
      ports: "{{ port_groups.pg12 }}"

  msd_n1111:
    name: msd_n1111
    fabric: "{{ msd_fabrics.MSD.name }}"
    net_name: n1111
    vrf_name: v1
    vlan_id: 1111
    gw_ip_subnet: "10.21.1.1/24"
    tag: 12345
    attach:
    - ip_address: "{{ devices.leaf_1.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_2.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_3.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_4.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_5.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_8.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.border_gateway_1.ip }}"
      ports: ""
    - ip_address: "{{ devices.border_gateway_2.ip }}"
      ports: ""
    - ip_address: "{{ devices.border_gateway_3.ip }}"
      ports: ""
    - ip_address: "{{ devices.border_gateway_4.ip }}"
      ports: ""

  msd_n1112:
    name: msd_n1112
    fabric: "{{ msd_fabrics.MSD.name }}"
    net_name: n1112
    vrf_name: v2
    vlan_id: 1112
    gw_ip_subnet: "10.22.1.1/24"
    tag: 12345
    attach:
    - ip_address: "{{ devices.leaf_1.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_2.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_3.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_4.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_5.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.leaf_8.ip }}"
      ports: "{{ port_groups.pg11 }}"
    - ip_address: "{{ devices.border_gateway_1.ip }}"
      ports: ""
    - ip_address: "{{ devices.border_gateway_2.ip }}"
      ports: ""
    - ip_address: "{{ devices.border_gateway_3.ip }}"
      ports: ""
    - ip_address: "{{ devices.border_gateway_4.ip }}"
      ports: ""

vrfs:
  f1_v1:
    name: f1_v1
    fabric: "{{ switch_fabrics.f1.name }}"
    vrf_name: v1
    vrf_id: 63031
    vlan_id: 3031
    vrf_template: Default_VRF_Universal
    vrf_extension_template: Default_VRF_Extension_Universal
    service_vrf_template: null
    attach:
    - ip_address: "{{ devices.leaf_1.ip }}"
    - ip_address: "{{ devices.leaf_2.ip }}"
    - ip_address: "{{ devices.leaf_3.ip }}"
    - ip_address: "{{ devices.leaf_4.ip }}"

  f1_v2:
    name: f1_v2
    fabric: "{{ switch_fabrics.f1.name }}"
    vrf_name: v2
    vrf_id: 63032
    vlan_id: 3032
    vrf_template: Default_VRF_Universal
    vrf_extension_template: Default_VRF_Extension_Universal
    service_vrf_template: null
    attach:
    - ip_address: "{{ devices.leaf_1.ip }}"
    - ip_address: "{{ devices.leaf_2.ip }}"
    - ip_address: "{{ devices.leaf_3.ip }}"
    - ip_address: "{{ devices.leaf_4.ip }}"

  f2_v1:
    name: f2_v1
    fabric: "{{ switch_fabrics.f2.name }}"
    vrf_name: v1
    vrf_id: 63031
    vlan_id: 3031
    vrf_template: Default_VRF_Universal
    vrf_extension_template: Default_VRF_Extension_Universal
    service_vrf_template: null
    attach:
    - ip_address: "{{ devices.leaf_5.ip }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
    - ip_address: "{{ devices.leaf_8.ip }}"

  f2_v2:
    name: f2_v2
    fabric: "{{ switch_fabrics.f2.name }}"
    vrf_name: v2
    vrf_id: 63032
    vlan_id: 3032
    vrf_template: Default_VRF_Universal
    vrf_extension_template: Default_VRF_Extension_Universal
    service_vrf_template: null
    attach:
    - ip_address: "{{ devices.leaf_5.ip }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
    - ip_address: "{{ devices.leaf_8.ip }}"

### If using an MSD fabric to interconnect sites, we need to apply networks and
### VRFs to the MSD fabric, rather than the individual site fabrics.  The
### VRFs below are duplicates of the above site/switch fabric VRFs but additionally define
### attachments for the border_gateway roles, and will be used if the fabric name
### is an MSD fabric.

  msd_v1:
    name: msd_v1
    fabric: "{{ msd_fabrics.MSD.name }}"
    vrf_name: v1
    vrf_id: 63031
    vlan_id: 3031
    vrf_template: Default_VRF_Universal
    vrf_extension_template: Default_VRF_Extension_Universal
    service_vrf_template: null
    attach:
    - ip_address: "{{ devices.leaf_1.ip }}"
    - ip_address: "{{ devices.leaf_2.ip }}"
    - ip_address: "{{ devices.leaf_3.ip }}"
    - ip_address: "{{ devices.leaf_4.ip }}"
    - ip_address: "{{ devices.leaf_5.ip }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
    - ip_address: "{{ devices.leaf_8.ip }}"
    - ip_address: "{{ devices.border_gateway_1.ip }}"
    - ip_address: "{{ devices.border_gateway_2.ip }}"
    - ip_address: "{{ devices.border_gateway_3.ip }}"
    - ip_address: "{{ devices.border_gateway_4.ip }}"

  msd_v2:
    name: msd_v2
    fabric: "{{ msd_fabrics.MSD.name }}"
    vrf_name: v2
    vrf_id: 63032
    vlan_id: 3032
    vrf_template: Default_VRF_Universal
    vrf_extension_template: Default_VRF_Extension_Universal
    service_vrf_template: null
    attach:
    - ip_address: "{{ devices.leaf_1.ip }}"
    - ip_address: "{{ devices.leaf_2.ip }}"
    - ip_address: "{{ devices.leaf_3.ip }}"
    - ip_address: "{{ devices.leaf_4.ip }}"
    - ip_address: "{{ devices.leaf_5.ip }}"
    - ip_address: "{{ devices.leaf_6.ip }}"
    - ip_address: "{{ devices.leaf_7.ip }}"
    - ip_address: "{{ devices.leaf_8.ip }}"
    - ip_address: "{{ devices.border_gateway_1.ip }}"
    - ip_address: "{{ devices.border_gateway_2.ip }}"
    - ip_address: "{{ devices.border_gateway_3.ip }}"
    - ip_address: "{{ devices.border_gateway_4.ip }}"

# VPC Peers
vpc_peers:
  vpc_1:
    vpc_name: vpc_1
    peer_1: leaf_1
    peer_2: leaf_2
  vpc_2:
    vpc_name: vpc_2
    peer_1: leaf_3
    peer_2: leaf_4
  vpc_3:
    vpc_name: vpc_3
    peer_1: leaf_5
    peer_2: leaf_6
  vpc_4:
    vpc_name: vpc_4
    peer_1: leaf_7
    peer_2: leaf_8

# VPC Interfaces
vpc_interfaces:
  vpci_1111:
    vpc_name: vpc_1
    vpc_port_id: vpi11
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true 
    port_channel_mode: active 
    peer1_allowed_vlans: 1111
    peer2_allowed_vlans: 1111
    member_list:
    - Ethernet1/11

  vpci_1112:
    vpc_name: vpc_1
    vpc_port_id: vpi12
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true
    port_channel_mode: active
    peer1_allowed_vlans: 1112
    peer2_allowed_vlans: 1112
    member_list:
    - Ethernet1/12

  vpci_1211:
    vpc_name: vpc_2
    vpc_port_id: vpi11
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true
    port_channel_mode: active
    peer1_allowed_vlans: 1111
    peer2_allowed_vlans: 1111
    member_list:
    - Ethernet1/11

  vpci_1212:
    vpc_name: vpc_2
    vpc_port_id: vpi12
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true
    port_channel_mode: active
    peer1_allowed_vlans: 1112
    peer2_allowed_vlans: 1112
    member_list:
    - Ethernet1/12

# f2
  vpci_2111:
    vpc_name: vpc_3
    vpc_port_id: vpi11
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true
    port_channel_mode: active
    peer1_allowed_vlans: 1111
    peer2_allowed_vlans: 1111
    member_list:
    - Ethernet1/11

  vpci_2112:
    vpc_name: vpc_3
    vpc_port_id: vpi12
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true
    port_channel_mode: active
    peer1_allowed_vlans: 1112
    peer2_allowed_vlans: 1112
    member_list:
    - Ethernet1/12

  vpci_2211:
    vpc_name: vpc_4
    vpc_port_id: vpi11
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true
    port_channel_mode: active
    peer1_allowed_vlans: 1111
    peer2_allowed_vlans: 1111
    member_list:
    - Ethernet1/11

  vpci_2212:
    vpc_name: vpc_4
    vpc_port_id: vpi12
    interface_mode: trunk
    mtu: jumbo
    port_type_fast: true
    bpdu_guard: true
    port_channel_mode: active
    peer1_allowed_vlans: 1112
    peer2_allowed_vlans: 1112
    member_list:
    - Ethernet1/12

service_nodes:
  sn_1:
    service_node_name: "sn_1"
    external_fabric_name: "{{ external_fabrics.sn_fabric_1.name }}"
    # NOTE, service_node_type values are different between Ansible module
    # dcnm_service_node and the REST API.  Since ndfc-roles offers roles
    # based on both, you need to ensure that you're using the correct
    # service_node_type values, per below (these are case-sensitive):
    # REST: "Firewall" "ADC" "VNF" 
    # dcnm_service_node: firewall, load_balancer, virtual_network_function
    service_node_type: "firewall" # dcnm_service_node
    # service_node_type: "Firewall" # REST
    service_node_form_factor: "Virtual"
    service_node_peer_name: "foo"
    service_node_interface_name: "Ethernet1/1"
    attached_fabric_name: "{{ switch_fabrics.f1.name }}"
    attached_switch_name: "leaf_1"
    attached_switch_interface_name: "Ethernet1/1"
    vpc_switches_attached: false
    link_template_name: "service_link_trunk"
    interface_speed: "Auto"
    interface_mtu: "jumbo"
    interface_allowed_vlans: "all"
    interface_bpduguard_enabled: true
    interface_porttype_fast_enabled: true
    interface_admin_state: true

  sn_2:
    service_node_name: "sn_2"
    external_fabric_name: "{{ external_fabrics.sn_fabric_2.name }}"
    # see note for service_node_type above
    service_node_type: "firewall"
    service_node_form_factor: "Virtual"
    service_node_peer_name: "bar"
    service_node_interface_name: "Ethernet1/1"
    attached_fabric_name: "{{ switch_fabrics.f1.name }}"
    attached_switch_name: "leaf_2"
    attached_switch_interface_name: "Ethernet1/1"
    vpc_switches_attached: false
    link_template_name: "service_link_trunk"
    interface_speed: "Auto"
    interface_mtu: "jumbo"
    interface_allowed_vlans: "all"
    interface_bpduguard_enabled: true
    interface_porttype_fast_enabled: true
    interface_admin_state: true

  sn_3:
    service_node_name: "sn_3"
    external_fabric_name: "{{ external_fabrics.sn_fabric_3.name }}"
    service_node_type: "Firewall"
    service_node_form_factor: "Virtual"
    service_node_peer_name: "foobar"
    service_node_interface_name: "Ethernet1/1"
    attached_fabric_name: "{{ switch_fabrics.f2.name }}"
    attached_switch_name: "leaf_1"
    attached_switch_interface_name: "Ethernet1/1"
    vpc_switches_attached: false
    link_template_name: "service_link_trunk"
    interface_speed: "Auto"
    interface_mtu: "jumbo"
    interface_allowed_vlans: "all"
    interface_bpduguard_enabled: true
    interface_porttype_fast_enabled: true
    interface_admin_state: true

service_route_peerings:
  srp_1:
    name: srp_1
    state: merged
    fabric: "{{ switch_fabrics.f1.name }}"
    service_fabric: "{{ external_fabrics.sn_fabric_1.name }}"
    attach: true
    deploy: true
    config:
      - name: it_fw_srp_1                                # mandatory
        node_name: sn_2                                  # mandatory
        deploy_mode: intra_tenant_fw                     # mandatory, choices=[intra_tenant_fw, inter_tenant_fw]
        inside_network:                                  #
          name: "{{ networks.f1_n1111.net_name }}"       # mandatory
          vrf: "{{ networks.f1_n1111.vrf_name }}"        # mandatory
          vlan_id: "{{ networks.f1_n1111.vlan_id }}"
          profile:
            ipv4_gw: "{{ networks.f1_n1111.gw_ip_subnet }}" # mandatory
            #ipv6_gw: 2001:db01::1/64                       # optional, default is ''
            vlan_name: "inside.{{ networks.f1_n1111.vrf_name }}.{{ networks.f1_n1111.vlan_id }}" # optional, default is ''
            int_descr: "RP1 SN1 inside interface"        # optional, default is ''
            tag:  "{{ networks.f1_n1111.tag }}"          # optional, default is 12345
        next_hop: 10.21.1.100                            # mandatory
        outside_network:                                 #
          name: "{{ networks.f1_n1112.net_name }}"       # mandatory
          vrf: "{{ networks.f1_n1112.vrf_name }}"        # mandatory
          vlan_id: "{{ networks.f1_n1112.vlan_id }}"     # optional
          profile:
            ipv4_gw: "{{ networks.f1_n1112.gw_ip_subnet }}" # mandatory
            #ipv6_gw: 2001:db02::1/64                    # optional, default is ''
            vlan_name: "outside.{{ networks.f1_n1112.vrf_name }}.{{ networks.f1_n1112.vlan_id }}" # optional, default is ''
            int_descr: "RP1 SN1 outside interface"       # optional, default is ''
            tag:  "{{ networks.f1_n1112.tag }}"          # optional, default is 12345
        reverse_next_hop: 10.22.1.100                    # optional, default is ''
